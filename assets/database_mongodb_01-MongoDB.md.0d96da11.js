import{o as n,c as l,a,b as s}from"./app.2c953ec7.js";const t='{"title":"认识 MongoDB","description":"","frontmatter":{},"headers":[{"level":2,"title":"什么是 MongoDB？","slug":"什么是-mongodb？"},{"level":2,"title":"为什么叫文档数据库","slug":"为什么叫文档数据库"},{"level":2,"title":"谁开发的 MongoDB？","slug":"谁开发的-mongodb？"},{"level":2,"title":"主要用途","slug":"主要用途"},{"level":2,"title":"主要特点","slug":"主要特点"},{"level":2,"title":"MongoDB 是免费的吗？","slug":"mongodb-是免费的吗？"},{"level":2,"title":"MongoDB 与关系型数据库","slug":"mongodb-与关系型数据库"},{"level":2,"title":"MongoDB 的优势及特点","slug":"mongodb-的优势及特点"},{"level":3,"title":"优势","slug":"优势"},{"level":2,"title":"安装 MongoDB 官网","slug":"安装-mongodb-官网"},{"level":2,"title":"MongoDB 基本操作","slug":"mongodb-基本操作"},{"level":3,"title":"连接数据库","slug":"连接数据库"},{"level":3,"title":"查看已有的数据库","slug":"查看已有的数据库"},{"level":3,"title":"查看当前数据库","slug":"查看当前数据库"},{"level":3,"title":"创建数据库或者切换数据库","slug":"创建数据库或者切换数据库"},{"level":3,"title":"查看当前数据库已有文档（表）","slug":"查看当前数据库已有文档（表）"},{"level":3,"title":"添加数据","slug":"添加数据"},{"level":3,"title":"查看文档模型中的数据","slug":"查看文档模型中的数据"},{"level":3,"title":"删除数据","slug":"删除数据"},{"level":3,"title":"更新数据","slug":"更新数据"},{"level":3,"title":"删除表","slug":"删除表"},{"level":3,"title":"删除数据库 dropDatabase","slug":"删除数据库-dropdatabase"},{"level":3,"title":"备份与恢复","slug":"备份与恢复"},{"level":2,"title":"查询","slug":"查询"},{"level":3,"title":"聚合查询","slug":"聚合查询"},{"level":3,"title":"聚合运算的使用场景","slug":"聚合运算的使用场景"},{"level":3,"title":"MQL 常用步骤与 SQL 对比","slug":"mql-常用步骤与-sql-对比"},{"level":3,"title":"MQL 特有步骤$unwind","slug":"mql-特有步骤-unwind"},{"level":3,"title":"MQL 特有的$bucket","slug":"mql-特有的-bucket"},{"level":3,"title":"MQL 特有的$facet","slug":"mql-特有的-facet"},{"level":2,"title":"复制集","slug":"复制集"},{"level":3,"title":"复制集的作用","slug":"复制集的作用"},{"level":3,"title":"典型复制集结构","slug":"典型复制集结构"},{"level":3,"title":"数据是如何复制的？","slug":"数据是如何复制的？"},{"level":3,"title":"选举时如何完成故障恢复的？","slug":"选举时如何完成故障恢复的？"},{"level":3,"title":"影响选举的因素","slug":"影响选举的因素"},{"level":3,"title":"常见选项","slug":"常见选项"},{"level":3,"title":"复制集注意事项","slug":"复制集注意事项"},{"level":3,"title":"Atlas-MongoDB 公有云托管服务","slug":"atlas-mongodb-公有云托管服务"}],"relativePath":"database/mongodb/01-MongoDB.md","lastUpdated":1627126477300}',e={},u=a("h1",{id:"认识-mongodb"},[a("a",{class:"header-anchor",href:"#认识-mongodb","aria-hidden":"true"},"#"),s(" 认识 MongoDB")],-1),o=a("h2",{id:"什么是-mongodb？"},[a("a",{class:"header-anchor",href:"#什么是-mongodb？","aria-hidden":"true"},"#"),s(" 什么是 MongoDB？")],-1),c=a("p",null,"一个以 json 为数据模型的文档数据库",-1),i=a("h2",{id:"为什么叫文档数据库"},[a("a",{class:"header-anchor",href:"#为什么叫文档数据库","aria-hidden":"true"},"#"),s(" 为什么叫文档数据库")],-1),p=a("p",null,'文档来自于 "JSON Document"，并非我们理解的 PDF、word 文档',-1),r=a("h2",{id:"谁开发的-mongodb？"},[a("a",{class:"header-anchor",href:"#谁开发的-mongodb？","aria-hidden":"true"},"#"),s(" 谁开发的 MongoDB？")],-1),d=a("p",null,"上市公司 MongoDB Inc，总部位于美国纽约",-1),g=a("h2",{id:"主要用途"},[a("a",{class:"header-anchor",href:"#主要用途","aria-hidden":"true"},"#"),s(" 主要用途")],-1),k=a("p",null,"应用数据库，类似于 Oracle、MySQL 海量数据处理，数据平台",-1),h=a("h2",{id:"主要特点"},[a("a",{class:"header-anchor",href:"#主要特点","aria-hidden":"true"},"#"),s(" 主要特点")],-1),f=a("ul",null,[a("li",null,"建模为可选"),a("li",null,"JSON 数据模型比较适合开发"),a("li",null,"横向扩展可以支撑很大数据量和并发"),a("li",null,"易扩展、高性能、高可用"),a("li",null,"较容易映射复杂数据（key-value）"),a("li",null,[s("无事务特性要求（ACID 特性） "),a("ul",null,[a("li",null,"A： 原则性"),a("li",null,"C： 一致性"),a("li",null,"I： 独立性"),a("li",null,"D：持久性")])])],-1),b=a("h2",{id:"mongodb-是免费的吗？"},[a("a",{class:"header-anchor",href:"#mongodb-是免费的吗？","aria-hidden":"true"},"#"),s(" MongoDB 是免费的吗？")],-1),m=a("ul",null,[a("li",null,"MongoDB 有两个发布版本：社区版和企业版"),a("li",null,"社区办基于 SSPL，一种和 AGPL 基本类似的开源协议"),a("li",null,"企业版是基于商业协议，需要付费使用")],-1),A=a("h2",{id:"mongodb-与关系型数据库"},[a("a",{class:"header-anchor",href:"#mongodb-与关系型数据库","aria-hidden":"true"},"#"),s(" MongoDB 与关系型数据库")],-1),v=a("p",null,[a("img",{src:"/assets/1616208952573-8ffd239b-c069-4649-bbd1-06111aa15486.1c8eabe0.png",alt:"image.png"})],-1),B=a("h2",{id:"mongodb-的优势及特点"},[a("a",{class:"header-anchor",href:"#mongodb-的优势及特点","aria-hidden":"true"},"#"),s(" MongoDB 的优势及特点")],-1),S=a("h3",{id:"优势"},[a("a",{class:"header-anchor",href:"#优势","aria-hidden":"true"},"#"),s(" 优势")],-1),D=a("ul",null,[a("li",null,"面向开发者的医用 + 高效数据库")],-1),Q=a("p",null,[a("img",{src:"/assets/1616209245470-ff96a30f-5e85-4c2e-be81-a4eaccb87d39.ce35296a.png",alt:"image.png"})],-1),I=a("ul",null,[a("li",null,[a("p",null,"一目了然的对象模型")]),a("li",null,[a("ul",null,[a("li",null,"文档模型与数据库中的文档一一对应")])])],-1),C=a("p",null,[a("img",{src:"/assets/1616209303962-2bcb6794-2ce8-41ab-a93b-4ece07b2b620.d0cc6111.png",alt:"image.png"})],-1),L=a("ul",null,[a("li",null,[s("灵活：快速响应业务变化 "),a("ul",null,[a("li",null,"多形性：同一集合可以包含不同字段(类型)的文档对象"),a("li",null,"动态性：线上修改数据模式，修改时应用与数据库均无需下线"),a("li",null,"数据治理：支持使用 JSON Schema 来规范数据模式，在保障模式灵活动态的前提下，提供数据治理能力")])])],-1),y=a("p",null,[a("img",{src:"/assets/1616209385224-53ab457b-5dc5-4981-b227-71024ecf19b9.24eb5a0a.png",alt:"image.png"})],-1),w=a("ul",null,[a("li",null,"快速：最简单快速的开发方式；JSON 模型之快速特性："),a("li",null,"数据库引擎只需要在一个存储区读写"),a("li",null,"反范式、无关联的组织极大优化查询速度"),a("li",null,"程序 API 自然开发快速")],-1),E=a("p",null,[a("img",{src:"/assets/1616209499188-822e92a3-ec8f-4391-8713-b84b7cc28234.9775cf8f.png",alt:"image.png"})],-1),M=a("ul",null,[a("li",null,[a("p",null,"原生的高可用和横向扩展能力")]),a("li",null,[a("ul",null,[a("li",null,"Replica Set-2 to 50 个成员"),a("li",null,"自恢复"),a("li",null,"多中心容灾能力"),a("li",null,"滚动服务 - 最小化服务终端")])])],-1),Y=a("p",null,[a("img",{src:"/assets/1616210262140-97cfc44e-e4e2-4e05-b4af-daab89cc325c.4904d47a.png",alt:"image.png"})],-1),J=a("ul",null,[a("li",null,[a("p",null,"横向扩展能力")]),a("li",null,[a("ul",null,[a("li",null,"需要的时候无缝扩展"),a("li",null,"应用全透明"),a("li",null,"多种数据分布策略"),a("li",null,"轻松支持 TB-PB 数量级")])])],-1),N=a("p",null,[a("img",{src:"/assets/1616210618591-9736183e-cfae-4dc6-aa45-e266b3b3fda3.977aef26.png",alt:"image.png"})],-1),O=a("h2",{id:"安装-mongodb-官网"},[a("a",{class:"header-anchor",href:"#安装-mongodb-官网","aria-hidden":"true"},"#"),s(" 安装 MongoDB "),a("a",{href:"https://www.mongodb.com/try",target:"_blank",rel:"noopener noreferrer"},"官网")],-1),R=a("h2",{id:"mongodb-基本操作"},[a("a",{class:"header-anchor",href:"#mongodb-基本操作","aria-hidden":"true"},"#"),s(" MongoDB 基本操作")],-1),q=a("h3",{id:"连接数据库"},[a("a",{class:"header-anchor",href:"#连接数据库","aria-hidden":"true"},"#"),s(" 连接数据库")],-1),X=a("ul",null,[a("li",null,"连接本地数据库")],-1),T=a("blockquote",null,[a("p",null,"Tips："),a("p",null,"windows 系统的话，本地的数据库必须添加环境变量，否则 mongod 或者 mongo 服务找不到")],-1),P=a("div",{class:"language-shell"},[a("pre",null,[a("code",null,[s("$ mongod "),a("span",{class:"token operator"},"<"),s("保存数据的文件夹路径"),a("span",{class:"token operator"},">"),s(" --port "),a("span",{class:"token number"},"27017"),s("\n")])])],-1),j=a("h3",{id:"查看已有的数据库"},[a("a",{class:"header-anchor",href:"#查看已有的数据库","aria-hidden":"true"},"#"),s(" 查看已有的数据库")],-1),F=a("div",{class:"language-shell"},[a("pre",null,[a("code",null,"show dbs\n")])],-1),z=a("p",null,[a("img",{src:"/assets/1616219506066-751483e7-c7db-4e6e-a0cc-24d524ec707c.4a2c6e4d.png",alt:"image.png"})],-1),G=a("h3",{id:"查看当前数据库"},[a("a",{class:"header-anchor",href:"#查看当前数据库","aria-hidden":"true"},"#"),s(" 查看当前数据库")],-1),U=a("div",{class:"language-shell"},[a("pre",null,[a("code",null,"db\n")])],-1),x=a("p",null,[a("img",{src:"data:image/png;base64,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",alt:"image.png"})],-1),Z=a("h3",{id:"创建数据库或者切换数据库"},[a("a",{class:"header-anchor",href:"#创建数据库或者切换数据库","aria-hidden":"true"},"#"),s(" 创建数据库或者切换数据库")],-1),W=a("div",{class:"language-shell"},[a("pre",null,[a("code",null,[s("// 如果有这个数据库的话就是切换，没有的话就是创建\nuse "),a("span",{class:"token operator"},"<"),s("数据库名"),a("span",{class:"token operator"},">"),s("\n")])])],-1),K=a("p",null,[a("img",{src:"/assets/1616219430156-ce874a39-bac3-46c2-96be-18efb6eb9453.7a4a84e4.png",alt:"image.png"})],-1),V=a("h3",{id:"查看当前数据库已有文档（表）"},[a("a",{class:"header-anchor",href:"#查看当前数据库已有文档（表）","aria-hidden":"true"},"#"),s(" 查看当前数据库已有文档（表）")],-1),$=a("div",{class:"language-shell"},[a("pre",null,[a("code",null,"show collections\n")])],-1),H=a("p",null,[a("img",{src:"data:image/png;base64,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",alt:"image.png"})],-1),_=a("h3",{id:"添加数据"},[a("a",{class:"header-anchor",href:"#添加数据","aria-hidden":"true"},"#"),s(" 添加数据")],-1),nn=a("p",null,"语法：",-1),ln=a("div",{class:"language-shell"},[a("pre",null,[a("code",null,[s("// 添加单条数据\ndb."),a("span",{class:"token operator"},"<"),s("collection"),a("span",{class:"token operator"},">"),s(".insertOne"),a("span",{class:"token punctuation"},"("),a("span",{class:"token operator"},"<"),s("JSON"),a("span",{class:"token operator"},">"),a("span",{class:"token punctuation"},")"),s("\n\n// 添加多条数据\ndb."),a("span",{class:"token operator"},"<"),s("collection"),a("span",{class:"token operator"},">"),s(".insertMany"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"["),a("span",{class:"token operator"},"<"),s("JSON "),a("span",{class:"token operator"},[a("span",{class:"token file-descriptor important"},"1"),s(">")]),s(", "),a("span",{class:"token operator"},"<"),s("JSON "),a("span",{class:"token operator"},[a("span",{class:"token file-descriptor important"},"2"),s(">")]),s(", "),a("span",{class:"token punctuation"},".."),s("., "),a("span",{class:"token operator"},"<"),s("JSON n"),a("span",{class:"token operator"},">"),a("span",{class:"token punctuation"},"]"),a("span",{class:"token punctuation"},")"),s("\n")])])],-1),an=a("ul",null,[a("li",null,"添加一条数据")],-1),sn=a("p",null,[a("img",{src:"/assets/1616219864202-be76b7bb-461a-486f-9376-7ed933e051d9.66f84c2f.png",alt:"image.png"})],-1),tn=a("ul",null,[a("li",null,"添加多条数据")],-1),en=a("p",null,[a("img",{src:"/assets/1616220248599-465e1c62-1403-4e77-b00f-d0b79c4acd30.2c3adcf7.png",alt:"image.png"})],-1),un=a("h3",{id:"查看文档模型中的数据"},[a("a",{class:"header-anchor",href:"#查看文档模型中的数据","aria-hidden":"true"},"#"),s(" 查看文档模型中的数据")],-1),on=a("blockquote",null,[a("ul",null,[a("li",null,"find()是 MongoDB 数据库查询数据的基本指令，相当于 SQL 中的 SELECT"),a("li",null,"find()返回游标")])],-1),cn=a("ul",null,[a("li",null,[a("p",null,"查询指定文档模型中的全部数据"),a("div",{class:"language-shell"},[a("pre",null,[a("code",null,[s("db."),a("span",{class:"token operator"},"<"),s("文档模型的名称"),a("span",{class:"token operator"},">"),s(".find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),s("\n")])])]),a("p",null,[a("img",{src:"/assets/1616220403969-bc2640de-55d2-464c-96d0-684d7a3e1925.6202e70f.png",alt:"image.png"})])]),a("li",null,[a("p",null,"单条件查询"),a("blockquote",null,[a("p",null,"查询一条 name 为 apple 的数据")]),a("p",null,[a("img",{src:"/assets/1616220964687-67cb91fd-fb76-49ff-bfd8-07f99b4d0816.5d038771.png",alt:"image.png"})])]),a("li",null,[a("p",null,"多条件 and 查询"),a("blockquote",null,[a("p",null,"查询一条 name 为 pear 和 weight 为 400 的数据")]),a("p",null,[a("img",{src:"/assets/1616221382117-14af946d-8c98-484f-aca9-f3e0c71a1b3d.873ca0f3.png",alt:"image.png"})])]),a("li",null,[a("p",null,"and 的另一种形式查询"),a("p",null,[a("img",{src:"/assets/1616221586954-a8348828-3671-4254-969f-782c5b053575.64376866.png",alt:"image.png"})])]),a("li",null,[a("p",null,"多条件 or 查询"),a("blockquote",null,[a("p",null,"查询 name 为 apple 或者 weight 为 400 的数据")]),a("p",null,[a("img",{src:"/assets/1616221660514-eda617db-5370-434a-968a-385d905f44df.91464524.png",alt:"image.png"})])]),a("li",null,[a("p",null,"按正则表达式查找"),a("blockquote",null,[a("p",null,"查找所有 name 中以 a 开头的所有数据")]),a("p",null,[a("img",{src:"/assets/1616221971504-fe951f06-5127-4b62-987c-18564806fdc1.f8ab5e89.png",alt:"image.png"})])])],-1),pn=a("p",null,"查询条件对照表",-1),rn=a("table",null,[a("thead",null,[a("tr",null,[a("th",null,[a("strong",null,[a("em",null,"逻辑运算符")])]),a("th",null,[a("strong",null,[a("em",null,"MongoDB 中的写法")])])])]),a("tbody",null,[a("tr",null,[a("td",null,"a 等于 1"),a("td",null,"{ a : 1 }")]),a("tr",null,[a("td",null,"a 不等于 1"),a("td",null,"{ a : { $ne : 1 } }")]),a("tr",null,[a("td",null,"a 大于 1"),a("td",null,"{ a : { $gt: 1 } }")]),a("tr",null,[a("td",null,"a 小于 1"),a("td",null,"{ a : { $lt : 1 } }")]),a("tr",null,[a("td",null,"a 大于等于 1"),a("td",null,"{ a : { $gte : 1 } }")]),a("tr",null,[a("td",null,"a 小于等于 1"),a("td",null,"{ a : { $lte : 1 } }")]),a("tr",null,[a("td",null,"a 等于 1 和 b 等于 1"),a("td",null,"{ a : 1, b : 1 }或者{ $and: [{ a : 1 }, { b : 1 }] }")]),a("tr",null,[a("td",null,"a 等于 1 或者 b 等于 1"),a("td",null,"{ $or: [{ a : 1 }, { b : 1 }] }")]),a("tr",null,[a("td",null,"判断 a 字段不存在"),a("td",null,"{ a : { $exists : false } }")]),a("tr",null,[a("td",null,"a 包含 1, 2, 3"),a("td",null,"{ a : { $in : [1, 2, 3] } }")])])],-1),dn=a("h4",{id:"查询的逻辑运算符"},[a("a",{class:"header-anchor",href:"#查询的逻辑运算符","aria-hidden":"true"},"#"),s(" 查询的逻辑运算符")],-1),gn=a("ul",null,[a("li",null,"$lt 存在并小于"),a("li",null,"$lte 存在并小于等于"),a("li",null,"$gt 存在并大于"),a("li",null,"$gte 存在并大于等于"),a("li",null,"$ne 不存在或者存在但不等于"),a("li",null,"$in 存在并在指定数组中"),a("li",null,"$nin 不存在或者不在指定数组中"),a("li",null,"$or 匹配两个或多个条件中的一个"),a("li",null,"$and 匹配全部条件")],-1),kn=a("h4",{id:"find-搜索子文档"},[a("a",{class:"header-anchor",href:"#find-搜索子文档","aria-hidden":"true"},"#"),s(" find 搜索子文档")],-1),hn=a("p",null,"find 支持使用“field.sub_field”的形式查询子文档。假设有一个文档：",-1),fn=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[s("db"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"insertOne"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s("\n    name"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'apple'"),a("span",{class:"token punctuation"},","),s("\n    from"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"{"),s("\n        country"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'China'"),a("span",{class:"token punctuation"},","),s("\n        province"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Chengdu'"),s("\n    "),a("span",{class:"token punctuation"},"}"),s("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s("\n\ndb"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s(),a("span",{class:"token string"},"'fruit.country'"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'China'"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s("\ndb"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s(" from"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"{"),s(" country"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'China'"),s(),a("span",{class:"token punctuation"},"}"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s(),a("span",{class:"token comment"},"// 等同于上一行语句"),s("\n")])])],-1),bn=a("h4",{id:"使用-find-搜索数组"},[a("a",{class:"header-anchor",href:"#使用-find-搜索数组","aria-hidden":"true"},"#"),s(" 使用 find 搜索数组")],-1),mn=a("ul",null,[a("li",null,"find 支持对数组中的元素进行搜索，假设有一个文档")],-1),An=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[s("db"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"insert"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"["),s("\n    "),a("span",{class:"token punctuation"},"{"),s(" name"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Apple'"),a("span",{class:"token punctuation"},","),s(" color"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"["),a("span",{class:"token string"},"'red'"),a("span",{class:"token punctuation"},","),s(),a("span",{class:"token string"},"'green'"),a("span",{class:"token punctuation"},"]"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},","),s("\n    "),a("span",{class:"token punctuation"},"{"),s(" name"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'mango'"),a("span",{class:"token punctuation"},","),s(" color"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"["),a("span",{class:"token string"},"'yellow'"),a("span",{class:"token punctuation"},","),s(),a("span",{class:"token string"},"'green'"),a("span",{class:"token punctuation"},"]"),s(),a("span",{class:"token punctuation"},"}"),s("\n"),a("span",{class:"token punctuation"},"]"),a("span",{class:"token punctuation"},")"),s("\n\n"),a("span",{class:"token comment"},"// 查询"),s("\ndb"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s(" color"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'red'"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s(),a("span",{class:"token comment"},"// 查询颜色为'red'的所有数据"),s("\n\ndb"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s(" $or"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"["),a("span",{class:"token punctuation"},"{"),s(" color"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'red'"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},","),s(),a("span",{class:"token punctuation"},"{"),s(" color"),a("span",{class:"token operator"},":"),s(" green "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},"]"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s(),a("span",{class:"token comment"},"// 查询颜色为'red'或者为'green'的所有数据"),s("\n\ndb"),a("span",{class:"token punctuation"},"."),s("movies"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"insertOne"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s("\n    title"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Raiders of the Lost Ark'"),a("span",{class:"token punctuation"},","),s("\n    filming_locations"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"["),s("\n        "),a("span",{class:"token punctuation"},"{"),s(" city"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Los Angeles'"),a("span",{class:"token punctuation"},","),s(" state"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'CA'"),a("span",{class:"token punctuation"},","),s(" country"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'USA'"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},","),s("\n        "),a("span",{class:"token punctuation"},"{"),s(" city"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Rome'"),a("span",{class:"token punctuation"},","),s(" state"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Lazio'"),a("span",{class:"token punctuation"},","),s(" country"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Italy'"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},","),s("\n        "),a("span",{class:"token punctuation"},"{"),s(" city"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Florence'"),a("span",{class:"token punctuation"},","),s(" state"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'SC'"),a("span",{class:"token punctuation"},","),s(" country"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'USA'"),s(),a("span",{class:"token punctuation"},"}"),s("\n    "),a("span",{class:"token punctuation"},"]"),s("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s("\n\n"),a("span",{class:"token comment"},"// 查询城市为Rome的记录"),s("\ndb"),a("span",{class:"token punctuation"},"."),s("movies"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s(),a("span",{class:"token string"},"'filming_locations.city'"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Rome'"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s("\n")])])],-1),vn=a("ul",null,[a("li",null,"在数组中搜索子对象的多个字段时，如果使用 $elemMatch，它表示必须是同一个")],-1),Bn=a("p",null,"子对象满足多个条件。考虑以下两个查询：",-1),Sn=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[s("db"),a("span",{class:"token punctuation"},"."),s("movies"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s("\n    "),a("span",{class:"token string"},"'filming_locations.city'"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Rome'"),a("span",{class:"token punctuation"},","),s("\n    "),a("span",{class:"token string"},"'filming_locations.country'"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'USA'"),s("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s("\ndb"),a("span",{class:"token punctuation"},"."),s("movies"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"find"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s("\n    filming_locations"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"{"),s("\n        $elemMatch"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"{"),s(" city"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'Rome'"),a("span",{class:"token punctuation"},","),s(" country"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'USA'"),s(),a("span",{class:"token punctuation"},"}"),s("\n    "),a("span",{class:"token punctuation"},"}"),s("\n"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s("\n")])])],-1),Dn=a("blockquote",null,[a("p",null,"控制 find 返回的字段"),a("ul",null,[a("li",null,[a("p",null,"find 可以指定只返回指定的字段；")]),a("li",null,[a("p",null,"_id 字段必须明确指明不返回，否则默认返回；")]),a("li",null,[a("p",null,"在 MongoDB 中我们称这为投影（projection）；")]),a("li",null,[a("p",null,'db.movies.find({"category": "action"},{"_id":0, title:1})； _id 不返回，title 返回')])])],-1),Qn=a("h3",{id:"删除数据"},[a("a",{class:"header-anchor",href:"#删除数据","aria-hidden":"true"},"#"),s(" 删除数据")],-1),In=a("ul",null,[a("li",null,"remove 命令需要配合查询条件使用"),a("li",null,"匹配查询条件的文档会被删除"),a("li",null,"指定一个文档条件会删除所有记录")],-1),Cn=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[s("db"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"remove"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s(" name"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token string"},"'apple'"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s(),a("span",{class:"token comment"},"// 删除所有name为apple的记录"),s("\n\ndb"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"remove"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),s(" weight"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token punctuation"},"{"),s(" $lt"),a("span",{class:"token operator"},":"),s(),a("span",{class:"token number"},"20"),s(),a("span",{class:"token punctuation"},"}"),s(),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s(),a("span",{class:"token comment"},"// 删除所有weight小于20的记录"),s("\n\ndb"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"remove"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},"{"),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s(),a("span",{class:"token comment"},"// 删除所有记录"),s("\n\ndb"),a("span",{class:"token punctuation"},"."),s("fruit"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"remove"),a("span",{class:"token punctuation"},"("),a("span",{class:"token punctuation"},")"),s(),a("span",{class:"token comment"},"// 不会删除任何东西，会报错"),s("\n")])])],-1),Ln=a("h3",{id:"更新数据"},[a("a",{class:"header-anchor",href:"#更新数据","aria-hidden":"true"},"#"),s(" 更新数据")],-1),yn=a("ul",null,[a("li",null,"Update 操作执行格式：db.<集合>.update(<查询条件>,<更新内容>)")],-1),wn=a("p",null,[a("img",{src:"/assets/1616224528605-0dfde638-032a-4326-bdd4-22cb76d8ff4a.0fe375f1.png",alt:"image.png"})],-1),En=a("blockquote",null,[a("p",null,"Tips:"),a("ul",null,[a("li",null,[a("p",null,"使用 updateOne 表示无论条件匹配多少条记录，始终只会更新一条")]),a("li",null,[a("p",null,"使用 updateMany 标识条件匹配多少条就更新多少条")]),a("li",null,[a("p",null,"updateOne/updateMany 方法要求更新条件部分必须具有以下之一，否则将报错")]),a("li",null,[a("ul",null,[a("li",null,"$set/$unset"),a("li",null,"$push/$pushAll/$pop"),a("li",null,"$pull/$pullAll"),a("li",null,"$addToSet")])])])],-1),Mn=a("p",null,"$push：增加一个对象到数组最后",-1),Yn=a("p",null,"$pushAll：增加多个对象到数组最后",-1),Jn=a("p",null,"$pop：从数组的最后删除一个对象",-1),Nn=a("p",null,"$pull：如果匹配指定的值，从数组中删除相应的对象",-1),On=a("p",null,"$pullAll：如果匹配任意的值，从数据中删除相对应的对象",-1),Rn=a("p",null,"$addToSet：如果不存在则增加一个值到数组",-1),qn=a("h3",{id:"删除表"},[a("a",{class:"header-anchor",href:"#删除表","aria-hidden":"true"},"#"),s(" 删除表")],-1),Xn=a("ul",null,[a("li",null,"集合中的所有文档都会被删除"),a("li",null,"吉和相关的索引也会被删除")],-1),Tn=a("div",{class:"language-"},[a("pre",null,[a("code",null,"db.<集合名>.drop()  // db.fruit.drop()\n")])],-1),Pn=a("h3",{id:"删除数据库-dropdatabase"},[a("a",{class:"header-anchor",href:"#删除数据库-dropdatabase","aria-hidden":"true"},"#"),s(" 删除数据库 dropDatabase")],-1),jn=a("ul",null,[a("li",null,"使用 db.dropDatabase()来删除数据库"),a("li",null,"数据库相应的文件也会被删除，磁盘空间将被释放")],-1),Fn=a("div",{class:"language-"},[a("pre",null,[a("code",null,"use <db> // 进入要删除的数据库\n// 也可以使用 db 命令来查看当前所在数据库\ndb.dropDatabase() // 删除当前库 这一句命令下去就删除了整个数据库\n")])],-1),zn=a("h3",{id:"备份与恢复"},[a("a",{class:"header-anchor",href:"#备份与恢复","aria-hidden":"true"},"#"),s(" 备份与恢复")],-1),Gn=a("ul",null,[a("li",null,"备份")],-1),Un=a("div",{class:"language-"},[a("pre",null,[a("code",null,"mongodump -h localhost -u <用户名> -p <密码> -d <数据库名> -o <指定目录>\n")])],-1),xn=a("blockquote",null,[a("p",null,"参数说明：")],-1),Zn=a("blockquote",null,[a("ul",null,[a("li",null,"-h 指向备份服务器"),a("li",null,"-u 用户名"),a("li",null,"-p 密码"),a("li",null,"-d 指定备份的数据；如果不写这个参数则备份全部数据库"),a("li",null,"-o 数据备份到那个目录")])],-1),Wn=a("div",{class:"language-"},[a("pre",null,[a("code",null,"mongorestore -h localhost -u <用户名> -p <密码> --dir <备份文件夹>\n")])],-1),Kn=a("h2",{id:"查询"},[a("a",{class:"header-anchor",href:"#查询","aria-hidden":"true"},"#"),s(" 查询")],-1),Vn=a("h3",{id:"聚合查询"},[a("a",{class:"header-anchor",href:"#聚合查询","aria-hidden":"true"},"#"),s(" 聚合查询")],-1),$n=a("h4",{id:"什么是-mongodb-聚合框架"},[a("a",{class:"header-anchor",href:"#什么是-mongodb-聚合框架","aria-hidden":"true"},"#"),s(" 什么是 MongoDB 聚合框架")],-1),Hn=a("blockquote",null,[a("p",null,"MongoDB 聚合框架（Aggregation Framework）是一个计算框架，它可以："),a("ul",null,[a("li",null,"作用在一个集合或者几个集合上"),a("li",null,"对集合的数据进行的一些列运算"),a("li",null,"讲这些数据转化为期望的形式")])],-1),_n=a("p",null,"从效果而言，聚合框架相当于 SQL 查询中的",-1),nl=a("ul",null,[a("li",null,"GROUP BY"),a("li",null,"LEFT OUTER JOIN"),a("li",null,"AS 等等")],-1),ll=a("h4",{id:"管道-pipeline-和步骤-stage"},[a("a",{class:"header-anchor",href:"#管道-pipeline-和步骤-stage","aria-hidden":"true"},"#"),s(" 管道(Pipeline)和步骤(Stage)")],-1),al=a("ul",null,[a("li",null,[a("p",null,"整个聚合运算过程成为管道（Pipeline），它由多个步骤组成；每个管道")]),a("li",null,[a("ul",null,[a("li",null,"接受一系列文档（原始数据）"),a("li",null,"每个步骤对这些文档进行一系列运算"),a("li",null,"结果文档输出给下一个步骤")])])],-1),sl=a("p",null,[a("img",{src:"/assets/1616722946746-5f6bcc8c-8fe6-4f06-8803-d48aeef442b8.57e027e9.png",alt:"image.png"})],-1),tl=a("div",{class:"language-js"},[a("pre",null,[a("code",null,[s("pipeline "),a("span",{class:"token operator"},"="),s(),a("span",{class:"token punctuation"},"["),s("$stage1"),a("span",{class:"token punctuation"},","),s(" $stage2"),a("span",{class:"token punctuation"},","),s(),a("span",{class:"token operator"},"..."),a("span",{class:"token operator"},"..."),a("span",{class:"token punctuation"},","),s(" $stageN"),a("span",{class:"token punctuation"},"]"),s("\n\ndb"),a("span",{class:"token punctuation"},"."),a("span",{class:"token operator"},"<"),a("span",{class:"token constant"},"COLLECTION"),a("span",{class:"token operator"},">"),a("span",{class:"token punctuation"},"."),a("span",{class:"token function"},"aggregate"),a("span",{class:"token punctuation"},"("),s("pipeline"),a("span",{class:"token punctuation"},","),s(),a("span",{class:"token punctuation"},"{"),s(" options "),a("span",{class:"token punctuation"},"}"),a("span",{class:"token punctuation"},")"),s("\n")])])],-1),el=a("table",null,[a("thead",null,[a("tr",null,[a("th",null,"步骤"),a("th",null,"作用"),a("th",null,"SQL 等价运算符")])]),a("tbody",null,[a("tr",null,[a("td",null,"$match"),a("td",null,"过滤"),a("td",null,"WHERE")]),a("tr",null,[a("td",null,"$project"),a("td",null,"投影"),a("td",null,"AS")]),a("tr",null,[a("td",null,"$sort"),a("td",null,"排序"),a("td",null,"ORDER BY")]),a("tr",null,[a("td",null,"$group"),a("td",null,"分组"),a("td",null,"GROUP BY")]),a("tr",null,[a("td",null,"$skip/$limit"),a("td",null,"结果限制"),a("td",null,"SKIP/LIMIT")]),a("tr",null,[a("td",null,"$looup"),a("td",null,"左外连接"),a("td",null,"LEFT OUTER JOIN")]),a("tr",null,[a("td",null,"$unwind"),a("td",null,"展开数组"),a("td",null,"N/A")]),a("tr",null,[a("td",null,"$graphLoopup"),a("td",null,"图搜索"),a("td",null,"N/A")]),a("tr",null,[a("td",null,"$facet/$bucket"),a("td",null,"分页搜索"),a("td",null,"N/A")])])],-1),ul=a("h3",{id:"聚合运算的使用场景"},[a("a",{class:"header-anchor",href:"#聚合运算的使用场景","aria-hidden":"true"},"#"),s(" 聚合运算的使用场景")],-1),ol=a("ul",null,[a("li",null,[a("p",null,"计算；比如")]),a("li",null,[a("ul",null,[a("li",null,"计算一段时间内的销售总额、均值"),a("li",null,"分析一段时间的净利润"),a("li",null,"分析购买人的年龄分布"),a("li",null,"分析学生成绩分布"),a("li",null,"统计员工绩效"),a("li",null,".....")])]),a("li",null,[a("p",null,"数据的复杂运用")])],-1),cl=a("h3",{id:"mql-常用步骤与-sql-对比"},[a("a",{class:"header-anchor",href:"#mql-常用步骤与-sql-对比","aria-hidden":"true"},"#"),s(" MQL 常用步骤与 SQL 对比")],-1),il=a("p",null,[a("img",{src:"/assets/1616735835149-4fa69238-f7ea-4c8e-b76f-61dc860d2b5b.c1fa6420.png",alt:"image.png"})],-1),pl=a("p",null,[a("img",{src:"/assets/1616735882990-5e0eaa21-3f88-42df-b98e-1b6d74f1a2af.55e858cd.png",alt:"image.png"})],-1),rl=a("h3",{id:"mql-特有步骤-unwind"},[a("a",{class:"header-anchor",href:"#mql-特有步骤-unwind","aria-hidden":"true"},"#"),s(" MQL 特有步骤$unwind")],-1),dl=a("p",null,[a("img",{src:"/assets/1616735977733-fbf68d59-58d5-4e40-b6b0-cccc8af707af.d1d76df9.png",alt:"image.png"})],-1),gl=a("h3",{id:"mql-特有的-bucket"},[a("a",{class:"header-anchor",href:"#mql-特有的-bucket","aria-hidden":"true"},"#"),s(" MQL 特有的$bucket")],-1),kl=a("p",null,[a("img",{src:"/assets/1616736066821-ec321bb0-cec5-4474-b0ea-e0b28c06e862.95340f60.png",alt:"image.png"})],-1),hl=a("h3",{id:"mql-特有的-facet"},[a("a",{class:"header-anchor",href:"#mql-特有的-facet","aria-hidden":"true"},"#"),s(" MQL 特有的$facet")],-1),fl=a("p",null,[a("img",{src:"/assets/1616736149325-a05797b7-521a-494d-b439-fefd0ae0db4a.37bb9e38.png",alt:"image.png"})],-1),bl=a("h2",{id:"复制集"},[a("a",{class:"header-anchor",href:"#复制集","aria-hidden":"true"},"#"),s(" 复制集")],-1),ml=a("h3",{id:"复制集的作用"},[a("a",{class:"header-anchor",href:"#复制集的作用","aria-hidden":"true"},"#"),s(" 复制集的作用")],-1),Al=a("blockquote",null,[a("ul",null,[a("li",null,[a("p",null,"MongoDB 复制集的主要意义在于实现服务高可用")]),a("li",null,[a("p",null,"它的现实依赖于两个方面的功能")]),a("li",null,[a("ul",null,[a("li",null,"数据写入时将数据迅速复制到另一个独立节点上"),a("li",null,"在接受写入的节点发生故障是自动选举出一个新的替代节点")])]),a("li",null,[a("p",null,"在实现高可用的同事，复制集实现了其他几个附加作用")]),a("li",null,[a("ul",null,[a("li",null,"数据分发：将数据从一个区域复制到另一个区域，减少另一个区域的读延迟"),a("li",null,"读写分离：不同类型的压力分别在不同的节点上执行"),a("li",null,"异地容灾：在数据中心发生故障的时候快速切换到异地")])])])],-1),vl=a("h3",{id:"典型复制集结构"},[a("a",{class:"header-anchor",href:"#典型复制集结构","aria-hidden":"true"},"#"),s(" 典型复制集结构")],-1),Bl=a("ul",null,[a("li",null,[a("p",null,"一个典型的复制集由 3 个以上具有投票权的节点组成，包括：")]),a("li",null,[a("ul",null,[a("li",null,"一个节点（PRIMARY）：接受读入操作和选举时投票"),a("li",null,"连个（或多个）从节点(SECONDERY)：复制节点上的新数据和选举时投票"),a("li",null,"不推荐使用 Arbiter（投票节点）")])])],-1),Sl=a("p",null,[a("img",{src:"/assets/1616727985993-8c80b589-0adb-468a-b1b1-e9444e0d9998.63b73eb3.png",alt:"image.png"})],-1),Dl=a("h3",{id:"数据是如何复制的？"},[a("a",{class:"header-anchor",href:"#数据是如何复制的？","aria-hidden":"true"},"#"),s(" 数据是如何复制的？")],-1),Ql=a("ul",null,[a("li",null,"当一个修改操作，无论是插入、更新或者删除，达到主节点时，它对数据的操作将被记录下来（经过一系列必要的转换），这些记录被称为 oplog"),a("li",null,"从节点通过在主节点上打开一个 tailable 游标不断获取新进入直接点的 oplog，并在自己的数据上回放，一次保持跟主节点的数据一致性")],-1),Il=a("p",null,[a("img",{src:"/assets/1616736435076-19160d34-62df-4528-9260-d5e68a4773e6.ffd7ca7c.png",alt:"image.png"})],-1),Cl=a("h3",{id:"选举时如何完成故障恢复的？"},[a("a",{class:"header-anchor",href:"#选举时如何完成故障恢复的？","aria-hidden":"true"},"#"),s(" 选举时如何完成故障恢复的？")],-1),Ll=a("ul",null,[a("li",null,"具有投票权的节点之间凉凉相互发送心跳"),a("li",null,"当 5 次心跳未收到时判断为节点失联（宕机、断网......）"),a("li",null,"如果失联的是主节点，从节点会发起选举，选出新的主节点"),a("li",null,"如果失恋的是从节点则不会产生新的选举"),a("li",null,[s("选举基于"),a("a",{href:"https://raft.github.io/",target:"_blank",rel:"noopener noreferrer"},"RAFT 一致性算法"),s("实现，选举成功的必要条件是大多数投票节点存活")]),a("li",null,"复制集中最多可以有 50 个节点，但具有投票权的节点最多 7 个")],-1),yl=a("h3",{id:"影响选举的因素"},[a("a",{class:"header-anchor",href:"#影响选举的因素","aria-hidden":"true"},"#"),s(" 影响选举的因素")],-1),wl=a("ul",null,[a("li",null,[a("p",null,"整个集群必须有大多数节点存活")]),a("li",null,[a("p",null,"被选举为主节点的节点必须")]),a("li",null,[a("ul",null,[a("li",null,"能够与多数节点建立连接"),a("li",null,"具有较新的 oplog（操作日志）"),a("li",null,"具有较高的优先级（如果有配置）")])])],-1),El=a("h3",{id:"常见选项"},[a("a",{class:"header-anchor",href:"#常见选项","aria-hidden":"true"},"#"),s(" 常见选项")],-1),Ml=a("ul",null,[a("li",null,[a("p",null,"复制及节点有以下常见的选置项：")]),a("li",null,[a("ul",null,[a("li",null,"是否具有投票权（v 参数）：有则参与投票（默认都有投票权）"),a("li",null,"优先级（priority 参数）：优先级越高的节点越优先成为主节点；优先级为 0 的节点无法成为主节点"),a("li",null,"隐藏（hidden 参数）：复制数据，但对应不可见；隐藏节点可以具有投票权，但优先级必须为 0"),a("li",null,"延迟（slaveDelay）：复制 n 秒之前的数据，保持与主节点的时间差")])])],-1),Yl=a("p",null,[a("img",{src:"/assets/1616737227979-ce259f0d-c75f-41ba-ae0e-63b358176af5.c79579b7.png",alt:"image.png"})],-1),Jl=a("h3",{id:"复制集注意事项"},[a("a",{class:"header-anchor",href:"#复制集注意事项","aria-hidden":"true"},"#"),s(" 复制集注意事项")],-1),Nl=a("ul",null,[a("li",null,[a("p",null,"关于硬件")]),a("li",null,[a("ul",null,[a("li",null,"因为正常的复制集节点都有可能成为主节点，他们的地位是一样的，因此硬件配置上必须一致"),a("li",null,"为例保证节点不会同时宕机，各节点使用的硬件必须具有独立性")])]),a("li",null,[a("p",null,"关于软件")]),a("li",null,[a("ul",null,[a("li",null,"复制集各节点软件版本必须一致，以避免出现不可预知的问题")])]),a("li",null,[a("p",null,"增加节点不会增加系统写性能")])],-1),Ol=a("h3",{id:"atlas-mongodb-公有云托管服务"},[a("a",{class:"header-anchor",href:"#atlas-mongodb-公有云托管服务","aria-hidden":"true"},"#"),s(" Atlas-MongoDB 公有云托管服务")],-1),Rl=a("p",null,[a("img",{src:"/assets/1616739691929-b7144c9f-c48e-451a-bae6-b9f2bb8e2f11.b44f4070.png",alt:"image.png"})],-1);e.render=function(a,s,t,e,ql,Xl){return n(),l("div",null,[u,o,c,i,p,r,d,g,k,h,f,b,m,A,v,B,S,D,Q,I,C,L,y,w,E,M,Y,J,N,O,R,q,X,T,P,j,F,z,G,U,x,Z,W,K,V,$,H,_,nn,ln,an,sn,tn,en,un,on,cn,pn,rn,dn,gn,kn,hn,fn,bn,mn,An,vn,Bn,Sn,Dn,Qn,In,Cn,Ln,yn,wn,En,Mn,Yn,Jn,Nn,On,Rn,qn,Xn,Tn,Pn,jn,Fn,zn,Gn,Un,xn,Zn,Wn,Kn,Vn,$n,Hn,_n,nl,ll,al,sl,tl,el,ul,ol,cl,il,pl,rl,dl,gl,kl,hl,fl,bl,ml,Al,vl,Bl,Sl,Dl,Ql,Il,Cl,Ll,yl,wl,El,Ml,Yl,Jl,Nl,Ol,Rl])};export default e;export{t as __pageData};
